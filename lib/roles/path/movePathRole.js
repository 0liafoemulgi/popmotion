"use strict";

var getAngle = require('../../inc/calc').angle;

var calcRotation = function (path, point, distance) {
    var testPoint = this.path.getPointAtLength(distance + 0.2);

    return getAngle(point, testPoint);
};

var SVGMovePathRole = {
    init: function () {
        this.pathLength = this.path.getTotalLength();
    },

    update: function (state) {
        var distance = state.progress * this.pathLength,
            newPoint = this.path.getPointAtLength(distance),
            rotation = this.autoRotate ? calcRotation(this.path, newPoint, distance) : state.rotation || 0;

        this.element.setAttribute('transform', 'translate(' + newPoint.x + ', ' + newPoint.y + ') rotate(' + rotation + ')');
    }
};

module.exports = SVGMovePathRole;
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIi4uLy4uLy4uL3NyYy9yb2xlcy9wYXRoL21vdmVQYXRoUm9sZS5qcyJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiQUFBQTs7QUFFQSxJQUFJLFdBQVcsUUFBUSxnQkFBUixFQUEwQixLQUExQjs7QUFFZixJQUFJLGVBQWUsVUFBVSxJQUFWLEVBQWdCLEtBQWhCLEVBQXVCLFFBQXZCLEVBQWlDO0FBQ2hELFFBQUksWUFBWSxLQUFLLElBQUwsQ0FBVSxnQkFBVixDQUEyQixXQUFXLEdBQVgsQ0FBdkMsQ0FENEM7O0FBR2hELFdBQU8sU0FBUyxLQUFULEVBQWdCLFNBQWhCLENBQVAsQ0FIZ0Q7Q0FBakM7O0FBTW5CLElBQUksa0JBQWtCO0FBQ2xCLFVBQU0sWUFBWTtBQUNkLGFBQUssVUFBTCxHQUFrQixLQUFLLElBQUwsQ0FBVSxjQUFWLEVBQWxCLENBRGM7S0FBWjs7QUFJTixZQUFRLFVBQVUsS0FBVixFQUFpQjtBQUNyQixZQUFJLFdBQVcsTUFBTSxRQUFOLEdBQWlCLEtBQUssVUFBTDtZQUM1QixXQUFXLEtBQUssSUFBTCxDQUFVLGdCQUFWLENBQTJCLFFBQTNCLENBQVg7WUFDQSxXQUFXLEtBQUssVUFBTCxHQUFrQixhQUFhLEtBQUssSUFBTCxFQUFXLFFBQXhCLEVBQWtDLFFBQWxDLENBQWxCLEdBQWdFLE1BQU0sUUFBTixJQUFrQixDQUFsQixDQUgxRDs7QUFLckIsYUFBSyxPQUFMLENBQWEsWUFBYixDQUEwQixXQUExQixFQUF1QyxlQUFlLFNBQVMsQ0FBVCxHQUFhLElBQTVCLEdBQW1DLFNBQVMsQ0FBVCxHQUFhLFdBQWhELEdBQThELFFBQTlELEdBQXlFLEdBQXpFLENBQXZDLENBTHFCO0tBQWpCO0NBTFI7O0FBY0osT0FBTyxPQUFQLEdBQWlCLGVBQWpCIiwiZmlsZSI6Im1vdmVQYXRoUm9sZS5qcyIsInNvdXJjZXNDb250ZW50IjpbIlwidXNlIHN0cmljdFwiO1xuXG52YXIgZ2V0QW5nbGUgPSByZXF1aXJlKCcuLi8uLi9pbmMvY2FsYycpLmFuZ2xlO1xuXG52YXIgY2FsY1JvdGF0aW9uID0gZnVuY3Rpb24gKHBhdGgsIHBvaW50LCBkaXN0YW5jZSkge1xuICAgIHZhciB0ZXN0UG9pbnQgPSB0aGlzLnBhdGguZ2V0UG9pbnRBdExlbmd0aChkaXN0YW5jZSArIDAuMik7XG5cbiAgICByZXR1cm4gZ2V0QW5nbGUocG9pbnQsIHRlc3RQb2ludCk7XG59O1xuXG52YXIgU1ZHTW92ZVBhdGhSb2xlID0ge1xuICAgIGluaXQ6IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgdGhpcy5wYXRoTGVuZ3RoID0gdGhpcy5wYXRoLmdldFRvdGFsTGVuZ3RoKCk7XG4gICAgfSxcblxuICAgIHVwZGF0ZTogZnVuY3Rpb24gKHN0YXRlKSB7XG4gICAgICAgIHZhciBkaXN0YW5jZSA9IHN0YXRlLnByb2dyZXNzICogdGhpcy5wYXRoTGVuZ3RoLFxuICAgICAgICAgICAgbmV3UG9pbnQgPSB0aGlzLnBhdGguZ2V0UG9pbnRBdExlbmd0aChkaXN0YW5jZSksXG4gICAgICAgICAgICByb3RhdGlvbiA9IHRoaXMuYXV0b1JvdGF0ZSA/IGNhbGNSb3RhdGlvbih0aGlzLnBhdGgsIG5ld1BvaW50LCBkaXN0YW5jZSkgOiBzdGF0ZS5yb3RhdGlvbiB8fCAwO1xuXG4gICAgICAgIHRoaXMuZWxlbWVudC5zZXRBdHRyaWJ1dGUoJ3RyYW5zZm9ybScsICd0cmFuc2xhdGUoJyArIG5ld1BvaW50LnggKyAnLCAnICsgbmV3UG9pbnQueSArICcpIHJvdGF0ZSgnICsgcm90YXRpb24gKyAnKScpO1xuICAgIH1cbn07XG5cbm1vZHVsZS5leHBvcnRzID0gU1ZHTW92ZVBhdGhSb2xlOyJdfQ==