!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?t(require("popmotion"),require("popmotion/action"),require("popmotion/reactions/value"),require("react")):"function"==typeof define&&define.amd?define(["popmotion","popmotion/action","popmotion/reactions/value","react"],t):t(null,null,null,e.React)}(this,function(e,t,n,r){"use strict";var o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])};function i(e,t){function n(){this.constructor=e}o(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}var a=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var o in t=arguments[n])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e};function s(e,t){var n={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&t.indexOf(r)<0&&(n[r]=e[r]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var o=0;for(r=Object.getOwnPropertySymbols(e);o<r.length;o++)t.indexOf(r[o])<0&&(n[r[o]]=e[r[o]])}return n}var u=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var o in t=arguments[n])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e},f=function(e,t){return function(n){return Math.max(Math.min(n,t),e)}},c=function(e){return{test:(t=e,function(e){return"string"==typeof e&&-1!==e.indexOf(t)}),parse:parseFloat,transform:function(t){return""+t+e}};var t},l=function(e){return function(t){return"string"==typeof t&&0===t.indexOf(e)}},p=function(e){return e.substring(e.indexOf("(")+1,e.lastIndexOf(")"))},d=function(e){return"string"==typeof e?e.split(/,\s*/):[e]};function h(e){var t=e.length;return function(n){for(var r={},o=d(p(n)),i=0;i<t;i++)r[e[i]]=void 0!==o[i]?parseFloat(o[i]):1;return r}}var g={test:function(e){return"number"==typeof e},parse:parseFloat,transform:function(e){return e}},v=u({},g,{transform:f(0,1)}),m=c("deg"),y=c("%"),P=c("px"),w=u({},g,{default:1}),b=f(0,255),O=u({},g,{transform:function(e){return Math.round(b(e))}}),C={test:l("rgb"),parse:h(["red","green","blue","alpha"]),transform:function(e){var t=e.red,n=e.green,r=e.blue,o=e.alpha;return function(e){var t=e.red,n=e.green,r=e.blue,o=e.alpha;return"rgba("+t+", "+n+", "+r+", "+(void 0===o?1:o)+")"}({red:O.transform(t),green:O.transform(n),blue:O.transform(r),alpha:o})}},x={test:l("hsl"),parse:h(["hue","saturation","lightness","alpha"]),transform:function(e){var t=e.hue,n=e.saturation,r=e.lightness,o=e.alpha;return function(e){var t=e.hue,n=e.saturation,r=e.lightness,o=e.alpha;return"hsla("+t+", "+n+", "+r+", "+(void 0===o?1:o)+")"}({hue:Math.round(t),saturation:y.transform(n),lightness:y.transform(r),alpha:o})}},A=u({},C,{test:l("#"),parse:function(e){var t,n,r;return e.length>4?(t=e.substr(1,2),n=e.substr(3,2),r=e.substr(5,2)):(t=e.substr(1,1),n=e.substr(2,1),r=e.substr(3,1),t+=t,n+=n,r+=r),{red:parseInt(t,16),green:parseInt(n,16),blue:parseInt(r,16),alpha:1}}}),T={test:function(e){return C.test(e)||x.test(e)||A.test(e)},parse:function(e){return C.test(e)?C.parse(e):x.test(e)?x.parse(e):A.test(e)?A.parse(e):e},transform:function(e){return function(e){return void 0!==e.red}(e)?C.transform(e):function(e){return void 0!==e.hue}(e)?x.transform(e):e}},S=function(e){e.transition,e.delay,e.delayChildren,e.staggerChildren,e.staggerDirection,e.afterChildren,e.beforeChildren,e.preTransition;return s(e,["transition","delay","delayChildren","staggerChildren","staggerDirection","afterChildren","beforeChildren","preTransition"])},E=function(e,t){return"function"==typeof e?e(t):e},V=function(e,t,n,r){return e&&void 0!==e[t]?E(e[t],r):n},k=function(e){return function(t,n){void 0===n&&(n={});var r=e.state,o=e.poses,i=e.startAction,s=e.stopAction,u=e.getInstantTransition,f=e.addActionDelay,c=e.getTransitionProps,l=e.resolveTarget,p=e.transformPose,d=e.convertTransitionDefinition,h=r.children,g=r.values,v=r.props,m=r.activeActions,y=r.activePoses,P=n.delay,w=void 0===P?0:P,b=h.size,O=o[t],C=a({},v,n),x=function(){return b?function(e,t,n,r){var o=[],i=V(n,"delayChildren",0,r),s=V(n,"staggerChildren",0,r),u=V(n,"staggerDirection",1,r),f=(e.size-1)*s,c=1===u?function(e){return e*s}:function(e){return f-e*s};return Array.from(e).forEach(function(e,n){o.push(e.set(t,a({},r,{delay:i+c(n)})))}),o}(h,t,O,C):[]},A=function(){if(!O)return[];p&&(O=p(O,t,r));var e=O.preTransition,n=O.transition;return e&&O.preTransition(C),Object.keys(S(O)).map(function(e){return new Promise(function(r){var o=g.get(e),p=a({},C,{key:e,value:o}),h=l(o,E(O[e],p));m.has(e)&&s(m.get(e));var v=a({to:h},p,c(o,h,p)),P=function(e,t,n,r,o,i){var a;if("function"==typeof e)a=e(r);else if(e[t]||e.default){var s=e[t]||e.default;a="function"==typeof s?s(r):s}else a=e;return!1===a?i(n,r):o(n,a,r)}(n,e,o,v,d,u),b=E(O.delay,p);(w||b)&&(P=f(w||b,P)),m.set(e,i(o,P,r)),y.set(e,t)})})};if(O&&b){if(E(O.beforeChildren,C))return Promise.all(A()).then(function(){return Promise.all(x())});if(E(O.afterChildren,C))return Promise.all(x()).then(function(){return Promise.all(A())})}return Promise.all(A().concat(x()))}},D=function(e){return function(e){return e.includes("scale")}(e)?1:0},F=function(e,t,n){var r=t.userSetValues,o=t.createValue,i=t.convertValue,a=t.readValueFromSource,s=t.initialPose,u=t.poses,f=t.props;return function(t){if(!e.has(t)){var n;if(r&&void 0!==r[t])n=i(r[t],t,f);else{var c=function(e,t,n,r,o){void 0===o&&(o=D);var i=(Array.isArray(n)?n:[n]).find(function(n){return e[n]&&void 0!==e[n][t]});return i?E(e[i][t],r):o(t,r)}(u,t,s,f,a);n=o(c,t,f)}e.set(t,n)}}},M=function(e){var t=e.poses,n=e.passive,r=new Map;return Object.keys(t).forEach(function(e,t){return function(n){var r=t.poses[n];Object.keys(S(r)).forEach(F(e,t))}}(r,e)),n&&Object.keys(n).forEach(function(e,t){var n=t.passive,r=t.ancestorValues,o=t.createValue,i=t.readValue,a=t.props;return function(t){var s=n[t],u=s[0],f=s[1],c=s[2],l=c&&r.length?function(e,t,n){if(!0===t)return n[0]&&n[0].values.get(e);var r=n.find(function(e){return e.label===t});return r&&r.values.get(e)}(u,c,r):!!e.has(u)&&e.get(u);if(l){var p=o(i(l),t,a,{passiveParent:l,passiveProps:f,props:a});e.set(t,p)}}}(r,e)),r},I=function(e,t){return Object.keys(e).forEach(function(n){var r=e[n];e[n]=void 0!==r.transition?r:function(e,t,n){return a({},e,{transition:n.has(t)?n.get(t):n.get("default")})}(r,n,t)}),e},R=function(e){var t=e.getDefaultProps,n=e.defaultTransitions,r=e.bindOnChange,o=e.startAction,i=e.stopAction,u=e.readValue,f=e.readValueFromSource,c=e.resolveTarget,l=e.createValue,p=e.convertValue,d=e.getInstantTransition,h=e.getTransitionProps,g=e.addActionDelay,v=e.selectValueToRead,m=e.convertTransitionDefinition,y=e.transformPose,P=e.extendAPI;return function(e){var w=e.parentValues,b=e.ancestorValues,O=void 0===b?[]:b;w&&O.unshift({values:w});var C=new Map,x=new Map,A=new Set,T=I(function(e){e.label,e.props,e.values,e.parentValues,e.ancestorValues,e.onChange,e.passive,e.initialPose;return s(e,["label","props","values","parentValues","ancestorValues","onChange","passive","initialPose"])}(e),n),S=e.props||{};t&&(S=a({},S,t(e)));var E=e.passive,V=e.values,D=e.initialPose,F=M({poses:T,passive:E,ancestorValues:O,readValue:u,createValue:l,convertValue:p,readValueFromSource:f,userSetValues:V,initialPose:D,props:S}),R={activeActions:C,activePoses:x,children:A,props:S,values:F},L=e.onChange;L&&Object.keys(L).forEach(r(F,L));var Y=k({state:R,poses:T,getInstantTransition:d,getTransitionProps:h,convertTransitionDefinition:m,startAction:o,stopAction:i,resolveTarget:c,addActionDelay:g,transformPose:y});return P({set:Y,get:function(e){return e?v(F.get(e)):function(e,t){var n={};return e.forEach(function(e,r){return n[r]=t(e)}),n}(F,v)},has:function(e){return!!T[e]},setProps:function(e){return S=a({},S,e)},_addChild:function(t,n){var r=n(a({initialPose:D},t,{ancestorValues:[{label:e.label,values:F}].concat(O)}));return A.add(r),r},removeChild:function(e){return A.delete(e)},clearChildren:function(){A.forEach(function(e){return e.destroy()}),A.clear()},destroy:function(){C.forEach(i),A.forEach(function(e){return e.destroy()})}},R,e)}},L=0,Y="undefined"!=typeof window&&void 0!==window.requestAnimationFrame?function(e){return window.requestAnimationFrame(e)}:function(e){var t=Date.now(),n=Math.max(0,16.7-(t-L));L=t+n,setTimeout(function(){return e(L)},n)};function X(e){var t=[],n=[],r=0,o=!1,i=0;return{cancel:function(e){var t=n.indexOf(e);-1!==t&&n.splice(t,1)},process:function(){for(o=!0,t=(e=[n,t])[0],(n=e[1]).length=0,r=t.length,i=0;i<r;i++)t[i]();var e;o=!1},schedule:function(i,a){void 0===a&&(a=!1),e();var s=a&&o,u=s?t:n;-1===u.indexOf(i)&&(u.push(i),s&&(r=t.length))}}}"undefined"!=typeof performance&&performance.now;var j=!1;function _(){j||(j=!0,Y(H))}var Z=X(_),B=X(_),U=X(_),q=X(_);function H(e){j=!1,Z.process(),B.process(),U.process(),q.process()}var z,W=U.schedule,G=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var o in t=arguments[n])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e},N=function(e){var t=e.onRead,n=e.onRender,r=e.aliasMap,o=void 0===r?{}:r,i=e.useCache,a=void 0===i||i;return function(e){var r={},i=[],s=!1,u=function(e,t){var n=o[e]||e,a=r[n];r[n]=t,r[n]!==a&&(-1===i.indexOf(n)&&i.push(n),s||(s=!0,W(f)))};function f(t){return void 0===t&&(t=!1),(t||s)&&(n(r,e,i),s=!1,i.length=0),this}return{get:function(n){var i=o[n]||n;return i?a&&void 0!==r[i]?r[i]:t(i,e):r},set:function(e,t){if("string"==typeof e){if(void 0===t)return function(t){return u(e,t)};u(e,t)}else for(var n in e)e.hasOwnProperty(n)&&u(n,e[n]);return this},render:f}}},$=/([a-z])([A-Z])/g,J=function(e){return e.replace($,"$1-$2").toLowerCase()},K=new Map,Q=new Map,ee=["Webkit","Moz","O","ms",""],te=ee.length,ne=function(e,t){void 0===t&&(t=!1);var n=t?Q:K;return n.has(e)||function(e){if("undefined"!=typeof document){z=z||document.createElement("div");for(var t=0;t<te;t++){var n=ee[t],r=""===n,o=r?e:n+e.charAt(0).toUpperCase()+e.slice(1);o in z.style&&(K.set(e,o),Q.set(e,(r?"":"-")+J(o)))}}}(e),n.get(e)||e},re=["","X","Y","Z"],oe=["translate","scale","rotate","skew","transformPerspective"].reduce(function(e,t){return re.reduce(function(e,n){return e.push(t+n),e},e)},["x","y","z"]),ie=oe.reduce(function(e,t){return e[t]=!0,e},{}),ae=function(e){return!0===ie[e]},se=function(e,t){return oe.indexOf(e)-oe.indexOf(t)},ue=function(e){return"transformOriginX"===e||"transformOriginY"===e},fe={color:T,backgroundColor:T,outlineColor:T,fill:T,stroke:T,borderColor:T,borderTopColor:T,borderRightColor:T,borderBottomColor:T,borderLeftColor:T,borderRadius:P,width:P,maxWidth:P,height:P,maxHeight:P,top:P,left:P,bottom:P,right:P,rotate:m,rotateX:m,rotateY:m,rotateZ:m,scale:w,scaleX:w,scaleY:w,scaleZ:w,skewX:m,skewY:m,distance:P,translateX:P,translateY:P,translateZ:P,perspective:P,opacity:v,transformOriginX:y,transformOriginY:y,transformOriginZ:P},ce=function(e){return fe[e]},le="number",pe="object",de="transform-origin",he="transform",ge="translateZ",ve=";transform: none",me=function(e,t){return";"+e+":"+t};var ye=new Set(["scrollLeft","scrollTop"]),Pe=N({onRead:function(e,t){var n=t.element,r=t.preparseOutput,o=ce(e);if(ae(e))return o&&o.default||0;if(ye.has(e))return n[e];var i=window.getComputedStyle(n,null).getPropertyValue(ne(e,!0))||0;return r&&o&&o.parse?o.parse(i):i},onRender:function(e,t,n){var r=t.element,o=t.enableHardwareAcceleration;r.style.cssText+=function(e,t,n,r){void 0===t&&(t=!0),void 0===n&&(n=!0);for(var o=!0===t?Object.keys(e):t,i="",a="",s=!1,u=!0,f=!1,c=!1,l=o.length,p=0;p<l;p++){var d=o[p];if(ae(d)){for(var h in f=!0,e)ae(h)&&-1===o.indexOf(h)&&o.push(h);break}}o.sort(se);var g=o.length;for(p=0;p<g;p++)if(d=o[p],!r.has(d)){var v=ae(d),m=e[d],y=ce(d);v&&(y.default&&m!==y.default||!y.default&&0!==m)&&(u=!1),y&&(typeof m===le||typeof m===pe)&&y.transform&&(m=y.transform(m)),v?(a+=d+"("+m+") ",c=d===ge||c):ue(d)?(e[d]=m,s=!0):i+=me(ne(d,!0),m)}return s&&(i+=me(de,(e.transformOriginX||0)+" "+(e.transformOriginY||0)+" "+(e.transformOriginZ||0))),f&&(!c&&n&&(a+=ge+"(0)"),i+=me(he,u?ve:a)),i}(e,n,o,ye),-1!==n.indexOf("scrollLeft")&&(r.scrollLeft=e.scrollLeft),-1!==n.indexOf("scrollTop")&&(r.scrollTop=e.scrollTop)},aliasMap:{x:"translateX",y:"translateY",z:"translateZ",originX:"transformOriginX",originY:"transformOriginY",originZ:"transformOriginZ"},uncachedValues:ye}),we=function(e,t){return e/100*t+"px"},be={fill:T,stroke:T,scale:w,scaleX:w,scaleY:w,opacity:v,fillOpacity:v,strokeOpacity:v},Oe=N({onRead:function(e,t){var n=t.element;if(ae(e)){var r=function(e){return be[e]}(e);return r?r.default:0}return n.getAttribute(e)},onRender:function(e,t,n){var r=t.dimensions;!function(e,t){for(var n in t)t.hasOwnProperty(n)&&e.setAttribute(n,t[n])}(t.element,function(e,t,n,r){var o=!1,i=!1,a={},s=n?{pathLength:"0",pathSpacing:""+r}:void 0,u=void 0!==e.scale?e.scale||1e-7:e.scaleX||1,f=void 0!==e.scaleY?e.scaleY||1e-7:u||1,c=t.width*((e.originX||50)/100)+t.x,l=t.height*((e.originY||50)/100)+t.y,p=1*u*-c,d=1*f*-l,h=c/u,g=l/f,v={translate:"translate("+e.translateX+", "+e.translateY+") ",scale:"translate("+p+", "+d+") scale("+u+", "+f+") translate("+h+", "+g+") ",rotate:"rotate("+e.rotate+", "+c+", "+l+") ",skewX:"skewX("+e.skewX+") ",skewY:"skewY("+e.skewY+") "};for(var m in e)if(e.hasOwnProperty(m)){var y=e[m];ae(m)?o=!0:!n||"pathLength"!==m&&"pathSpacing"!==m||"number"!=typeof y?n&&"pathOffset"===m?a["stroke-dashoffset"]=we(-y,r):a[J(m)]=y:(i=!0,s[m]=we(y,r))}if(i&&(a["stroke-dasharray"]=s.pathLength+" "+s.pathSpacing),o)for(var m in a.transform="",v)if(v.hasOwnProperty(m)){var P="scale"===m?"1":"0";a.transform+=v[m].replace(/undefined/g,P)}return a}(e,r,t.isPath,t.pathLength))},aliasMap:{x:"translateX",y:"translateY",background:"fill"}}),Ce=N({useCache:!1,onRead:function(e){return"scrollTop"===e?window.pageYOffset:window.pageXOffset},onRender:function(e){var t=e.scrollTop,n=void 0===t?0:t,r=e.scrollLeft,o=void 0===r?0:r;return window.scrollTo(o,n)}}),xe=new WeakMap,Ae=function(e,t){var n;return e instanceof HTMLElement?n=function(e,t){return Pe(G({element:e,enableHardwareAcceleration:!0,preparseOutput:!0},t))}(e,t):e instanceof SVGElement?n=function(e){var t=e.getBBox(),n={element:e,dimensions:{x:t.x,y:t.y,width:t.width,height:t.height},isPath:!1};return"path"===e.tagName&&(n.isPath=!0,n.pathLength=e.getTotalLength()),Oe(n)}(e):"undefined"!=typeof window&&e===window&&(n=Ce(e)),xe.set(e,n),n},Te=function(e,t){return xe.has(e)?xe.get(e):Ae(e,t)};var Se,Ee=function(e){return function(t){return function(n){var r=n[e],o=t[r]||t.default;return!!o&&o(n)}}}("key");!function(e){e.width="width",e.height="height",e.left="left",e.right="right",e.top="top",e.bottom="bottom"}(Se||(Se={}));var Ve=e.easing.linear,ke=e.transform.interpolate,De=function(t){return function(n){return e.pointer((r={},r[t]=n,r)).pipe(function(e){return e[t]});var r}},Fe=De("x"),Me=De("y"),Ie=function(e,t,n,r){return function(o){var i=o.from,a=o.type,s=o.dimensions,u=o.dragBounds,f=e(s.measurementAsPixels(r,i,a)),c=[];return u&&(void 0!==u[t]&&c.push(function(e){return Math.max(e,s.measurementAsPixels(r,u[t],a))}),void 0!==u[n]&&c.push(function(e){return Math.min(e,s.measurementAsPixels(r,u[n],a))})),a===y&&c.push(ke([0,s.get(r)],[0,100])),c.length?f.pipe.apply(f,c):f}},Re=function(t){return e.action(function(e){var n=e.update,r=e.complete;n(t),r()})},Le=function(t){var n=t.from,r=t.velocity,o=t.to;return e.spring({from:n,to:o,velocity:r,stiffness:500,damping:25,restDelta:.5,restSpeed:10})},Ye=function(t){var n=t.from,r=t.velocity,o=t.to;return e.spring({from:n,to:o,velocity:r,stiffness:700,damping:0===o?100:35})},Xe=Ee({x:Le,y:Le,z:Le,rotate:Le,rotateX:Le,rotateY:Le,rotateZ:Le,scaleX:Ye,scaleY:Ye,scale:Ye,opacity:function(t){var n=t.from,r=t.to;return e.tween({from:n,to:r,ease:Ve})},default:e.tween}),je=Ee({x:Ie(Fe,"left","right",Se.width),y:Ie(Me,"top","bottom",Se.height)}),_e=new Map([["default",Xe],["dragging",je],["dragEnd",function(e){var t=e.from;return Re(t)}]]),Ze=[g,m,y,P],Be=function(e){return function(t){return t.test(e)}},Ue=function(t,n){return void 0===t&&(t=0),e.chain(e.delay(t),n)},qe=new Map([["tween",e.tween],["spring",e.spring],["decay",e.decay],["keyframes",e.keyframes],["physics",e.physics]]),He=e.easing.easeIn,ze=e.easing.easeOut,We=e.easing.easeInOut,Ge=e.easing.circIn,Ne=e.easing.circOut,$e=e.easing.circInOut,Je=e.easing.backIn,Ke=e.easing.backOut,Qe=e.easing.backInOut,et=e.easing.anticipate,tt=new Map([["easeIn",He],["easeOut",ze],["easeInOut",We],["circIn",Ge],["circOut",Ne],["circInOut",$e],["backIn",Je],["backOut",Ke],["backInOut",Qe],["anticipate",et]]),nt=function(t,n,r,o){var i=o.props;i.draggable&&function(t,n,r,o){var i=o.onDragStart,a=o.onDragEnd,s=e.listen(t,"mousedown touchstart").start(function(t){t.preventDefault(),r("dragging"),i&&i(t);var o=e.listen(document,"mouseup touchend").start(function(e){n.get("dragEndListener").stop(),r("dragEnd"),a&&a(e)});n.set("dragEndListener",o)});n.set("dragStartListener",s)}(t,n,r,i)},rt=function(e){var t=e.top,n=e.right,r=e.bottom;return{x:(e.left+n)/2,y:(t+r)/2}},ot=["width","height","top","left","bottom","right"],it=new Set(ot),at=function(e){return it.has(e)},st=function(t,n,r){var o=t.values,i=t.props;if(o.has(n)){var a=o.get(n).raw;a.update(r),a.update(r)}else o.set(n,{raw:e.value(r,function(e){return i.elementStyler.set(n,e)})})},ut=function(e,t){var n=e.props,r=n.dimensions,o=n.element,i=n.elementStyler;if(!r.has())return{};var s=r.get(),u=o.style.transform;o.style.transform="";var f=o.getBoundingClientRect();o.style.transform=u;var c=s.left===f.left?0:s.right===f.right?"100%":"50%",l=s.top===f.top?0:s.bottom===f.bottom?"100%":"50%";i.set({originX:c,originY:l});var p={};s.width!==f.width&&(st(e,"scaleX",s.width/f.width),p.scaleX=1),s.height!==f.height&&(st(e,"scaleY",s.height/f.height),p.scaleY=1);var d=rt(s),h=rt(f);return"50%"===c&&(st(e,"x",d.x-h.x),p.x=0),"50%"===l&&(st(e,"y",d.y-h.y),p.y=0),i.render(),a({},t,p)},ft=function(e,t){return n=t,Object.keys(n).some(at)?function(e,t){var n=e.props,r=n.dimensions,o=n.elementStyler;r.measure();t.width,t.height,t.top,t.left,t.bottom,t.right;var i=s(t,["width","height","top","left","bottom","right"]);return o.set(ot.reduce(function(n,r){var o,i;return void 0!==t[r]&&(n[r]=(o=t[r],i=e.props,"function"==typeof o?o(i):o)),n},{})).render(),ut(e,i)}(e,t):ut(e,t);var n},ct=function(e,t){var n,r,o,i=t.onDragStart,u=t.onDragEnd,f=t.draggable,c=t.dragBounds,l=s(t,["onDragStart","onDragEnd","draggable","dragBounds"]),p=a({flip:{}},l,{props:a({},l.props,{draggable:f,onDragStart:i,onDragEnd:u,dragBounds:c,element:e,elementStyler:(n=e,r={preparseOutput:!1},o="string"==typeof n?document.querySelector(n):n,Te(o,r)),dimensions:function(e){var t=!1,n={width:0,height:0,top:0,left:0,bottom:0,right:0};return{get:function(e){return e?n[e]:n},measure:function(){return n=e.getBoundingClientRect(),t=!0,n},measurementAsPixels:function(e,t,r){return r===y&&"number"==typeof t?t/100*n[e]:t},has:function(){return t}}}(e)})});if(f){var d=function(e){var t={preTransition:function(e){return e.dimensions.measure()}},n={};return!0!==e&&"x"!==e||(t.x=n.x=0),!0!==e&&"y"!==e||(t.y=n.y=0),{dragging:t,dragEnd:n}}(f),h=d.dragging,g=d.dragEnd;p.dragging=a({},p.dragging,h),p.dragEnd=a({},p.dragEnd,g)}return p},lt=function(t){var n=t.transformPose,r=t.addListenerToValue,o=t.extendAPI,i=t.readValueFromSource;return R({bindOnChange:function(e,t){return function(n){e.has(n)&&e.get(n).raw.subscribe(t[n])}},readValue:function(e){return e.raw.get()},createValue:function(t,n,o,i){var a=o.elementStyler,s=void 0===i?{}:i,u=s.passiveParent,f=s.passiveProps,c=u?function(t,n,r){var o=e.value(t).pipe(r);return n.raw.subscribe(o),{raw:o}}(t,u,f):function(t){var n=Ze.find(Be(t));return{raw:e.value(n===g?n.parse(t):t),type:n}}(t);return r&&c.raw.subscribe(r(n,a)),c},convertValue:function(e,t,n){var o=n.elementStyler;return r&&e.subscribe(r(t,o)),{raw:e,type:Ze.find(Be(e.get()))}},getTransitionProps:function(e,t){var n=e.raw,r=e.type;return{from:r?r.parse(n.get()):n.get(),velocity:n.getVelocity(),to:r?r.parse(t):t,type:r}},resolveTarget:function(e,t){var n=e.type;return n?n.parse(t):t},selectValueToRead:function(e){return e.raw},startAction:function(e,t,n){var r=e.raw,o=e.type,i={update:function(e){return r.update(e)},complete:n};return o?t.pipe(o.transform).start(i):t.start(i)},stopAction:function(e){return e.stop()},getInstantTransition:function(e,t){var n=t.to;return Re(n)},convertTransitionDefinition:function(t,n,r){if(function(e){return void 0!==e.start}(n))return n;var o=n.delay,i=n.min,u=n.max,f=n.round,c=function(t,n,r){var o=r.from,i=r.to,u=r.velocity,f=n.type,c=void 0===f?"tween":f,l=n.ease,p=s(n,["type","ease"]);if(qe.has(c),"tween"===c){var d=typeof l;if("function"!==d)if("string"===d)tt.has(l),l=tt.get(l);else if(Array.isArray(l)){l.length;var h=l[0],g=l[1],v=l[2],m=l[3];l=e.easing.cubicBezier(h,g,v,m)}}return qe.get(c)(a({from:o,to:i,velocity:u,ease:l},p))}(0,s(n,["delay","min","max","round"]),r),l=[];return o&&Ue(o,c),void 0!==i&&l.push(function(e){return Math.max(e,i)}),void 0!==u&&l.push(function(e){return Math.min(e,u)}),f&&l.push(Math.round),l.length?c.pipe.apply(c,l):c},addActionDelay:Ue,defaultTransitions:_e,transformPose:n,readValueFromSource:i,extendAPI:o})}({transformPose:function(e,t,n){var r=e.flip,o=s(e,["flip"]);return function(e,t,n){return n.props.element instanceof HTMLElement&&(!0===e||"flip"===t)}(r,t,n)?ft(n,o):o},addListenerToValue:function(e,t){return function(n){return t.set(e,n)}},readValueFromSource:function(e,t){var n=t.elementStyler.get(e);return isNaN(n)?n:parseFloat(n)},extendAPI:function(e,t,n){var r=t.props,o=t.activeActions,i=r.dimensions.measure,s=a({},e,{addChild:function(t,n){return e._addChild(ct(t,n),lt)},measure:i,flip:function(t){return t&&(i(),t()),e.set("flip")}});return nt(r.element,o,e.set,n),s}}),pt=r.createContext({}),dt=function(e,t){return Array.isArray(e)?-1!==e.indexOf(t):e===t},ht=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.children=new Set,t.childrenHandlers={registerChild:function(e){t.children.add(e),t.poser&&t.flushChildren()},onUnmount:function(e){return t.poser.removeChild(e)},getParentPoseConfig:function(){return t.props.poseConfig},getInitialPoseFromParent:function(){return t.getInitialPose()}},t.getRefs=function(){var e={};return"string"==typeof t.props.elementType?e.ref=t.setRef:(e.innerRef=t.setRef,e.hostRef=t.setRef),e},t.setRef=function(e){if(e instanceof Element||t.ref&&null===e){var n=t.props.innerRef;n&&n(e),t.ref=e}},t}return i(t,e),t.prototype.getInitialPose=function(){var e=this.props,t=e.getInitialPoseFromParent,n=e.pose,r=e._pose,o=e.initialPose;if(o)return o;var i=t&&t(),a=Array.isArray(n)?n:[n],s=Array.isArray(r)?r:[r];return Array.isArray(i)?i.concat(a,s):[i].concat(a,s)},t.prototype.getFirstPose=function(){var e=this.props,t=e.initialPose,n=e.pose,r=e._pose;if(t){var o=Array.isArray(n)?n:[n],i=Array.isArray(r)?r:[r];return o.concat(i)}},t.prototype.getSetProps=function(){var e,t=this.props,n=(t.children,t.elementType,t.poseConfig,t.onChange),r=(t.onValueChange,t.innerRef,t._pose,t.pose,t.initialPose,t.onPoseComplete,t.getParentPoseConfig,t.registerChild,t.onUnmount,t.getInitialPoseFromParent,t.popFromFlow),o=(t.values,t.parentValues,t.onDragStart,t.onDragEnd,s(t,["children","elementType","poseConfig","onChange","onValueChange","innerRef","_pose","pose","initialPose","onPoseComplete","getParentPoseConfig","registerChild","onUnmount","getInitialPoseFromParent","popFromFlow","values","parentValues","onDragStart","onDragEnd"]));return r&&this.ref&&this.ref instanceof HTMLElement?this.popStyle?o.style=this.popStyle:(o.style=a({},o.style,{position:"absolute",top:(e=this.ref).offsetTop,left:e.offsetLeft,width:e.offsetWidth,height:e.offsetHeight}),this.popStyle=o.style):this.popStyle=null,"function"==typeof n&&(o.onChange=n),o},t.prototype.componentDidMount=function(){var e=this;this.ref;var t,n=this.props,r=n.poseConfig,o=n.onChange,i=n.onValueChange,s=n.registerChild,u=n.values,f=n.parentValues,c=n.onDragStart,l=n.onDragEnd,p=a({},r,{initialPose:this.getInitialPose(),values:u||r.values,parentValues:f?(t=f,Object.keys(t).reduce(function(e,n){return e.set(n,{raw:t[n]}),e},new Map)):void 0,props:this.getSetProps(),onDragStart:c,onDragEnd:l,onChange:i||("function"!=typeof o?o:void 0)});s?s({element:this.ref,poseConfig:p,onRegistered:function(t){return e.initPoser(t)}}):this.initPoser(function(e,t){return lt(ct(e,t))}(this.ref,p))},t.prototype.UNSAFE_componentWillUpdate=function(e){var t=e.pose,n=e._pose;(dt(t,"flip")||dt(n,"flip"))&&this.poser.measure()},t.prototype.componentDidUpdate=function(e){var t=this.props,n=t.pose,r=t._pose;this.poser.setProps(this.getSetProps()),n===e.pose&&"flip"!==n||this.setPose(n),r===e._pose&&"flip"!==r||this.setPose(r)},t.prototype.componentWillUnmount=function(){if(this.poser){var e=this.props.onUnmount;e&&e(this.poser),this.poser.destroy()}},t.prototype.initPoser=function(e){this.poser=e,this.flushChildren();var t=this.getFirstPose();t&&this.setPose(t)},t.prototype.setPose=function(e){var t=this,n=this.props.onPoseComplete,r=Array.isArray(e)?e:[e];Promise.all(r.map(function(e){return e&&t.poser.set(e)})).then(function(){return n&&n()})},t.prototype.flushChildren=function(){var e=this;this.children.forEach(function(t){var n=t.element,r=t.poseConfig;return(0,t.onRegistered)(e.poser.addChild(n,r))}),this.children.clear()},t.prototype.render=function(){var e=this.props,t=e.elementType,n=e.children;return r.createElement(pt.Provider,{value:this.childrenHandlers},r.createElement(t,a({},this.getSetProps(),this.getRefs()),n))},t}(r.PureComponent),gt=new Map,vt=function(e){return gt.has(e)?gt.get(e):function(e){var t=function(t){return void 0===t&&(t={}),function(n){var o=n.withParent,i=void 0===o||o,u=s(n,["withParent"]);return!i||u.parentValues?r.createElement(ht,a({poseConfig:t,elementType:e},u)):r.createElement(pt.Consumer,null,function(n){return r.createElement(ht,a({poseConfig:t,elementType:e},u,n))})}};return gt.set(e,t),t}(e)},mt=function(e){return vt(e)};["a","article","aside","audio","b","blockquote","body","br","button","canvas","caption","cite","code","col","colgroup","data","datalist","dialog","div","em","embed","fieldset","figcaption","figure","footer","form","h1","h2","h3","h4","h5","h6","head","header","hgroup","hr","i","iframe","img","input","label","legend","li","nav","object","ol","option","p","param","picture","pre","progress","q","section","select","span","strong","table","tbody","td","textarea","tfoot","th","thead","time","title","tr","ul","video","circle","clipPath","defs","ellipse","g","image","line","linearGradient","mask","path","pattern","polygon","polyline","radialGradient","rect","stop","svg","text","tspan"].reduce(function(e,t){return e[t]=vt(t),e},mt);var yt=r.Children,Pt=r.cloneElement,wt=function(e){return e.key},bt=function(e,t,n){var r=[];return yt.forEach(e,function(e){return r.push(Pt(e,{pose:t,initialPose:n}))}),r},Ot=function(e){var t=e.displayedChildren,n=e.incomingChildren,r=e.animateOnMount,o=e.preEnterPose,i=e.enterPose;return!t&&r?bt(n,i,o):t?function(e){var t=e.incomingChildren,n=e.displayedChildren,r=e.isLeaving,o=e.removeFromTree,i=e.preEnterPose,a=e.enterPose,s=e.exitPose,u=e.flipMove,f=[],c=n.map(wt),l=t.map(wt),p=new Set(l.filter(function(e){return r.has(e)||-1===c.indexOf(e)}));p.forEach(function(e){return r.delete(e)});var d=c.filter(function(e){return!p.has(e)&&(r.has(e)||-1===l.indexOf(e))});d.forEach(function(e){return r.add(e)});var h=new Set(c.filter(function(e,t){var n=l.indexOf(e);return!p.has(e)&&-1!==n&&t!==n}));return t.forEach(function(e){var t=p.has(e.key)?{initialPose:i,_pose:a}:h.has(e.key)&&u?{_pose:[a,"flip"]}:{_pose:a};f.push(Pt(e,t))}),d.forEach(function(e){var t=n.find(function(t){return t.key===e}),r=Pt(t,{_pose:s,onPoseComplete:o(e),popFromFlow:u}),i=c.indexOf(e);f.splice(i,0,r)}),f}(e):bt(n,i)},Ct=r.Fragment,xt=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.state={incomingChildren:[],isLeaving:new Set,removeFromTree:function(e){return function(){t.state.isLeaving.delete(e),t.removeFromChildren(e)}}},t}return i(t,e),t.prototype.removeFromChildren=function(e){var t=this.state.children;this.setState({children:function(e,t){return e.filter(function(e){return e.key!==t})}(t,e)})},t.prototype.shouldComponentUpdate=function(e,t){return this.state!==t},t.prototype.render=function(){var e=this.state.children;return r.createElement(Ct,null,e)},t.defaultProps={flipMove:!0,preEnterPose:"exit",enterPose:"enter",exitPose:"exit",singleChildOnly:!1},t.getDerivedStateFromProps=function(e,t){var n=t.isLeaving,r=t.removeFromTree,o=t.children,i=function(e){var t=[];return yt.forEach(e,function(e){return e&&t.push(e)}),t}(e.children);return{incomingChildren:i,children:Ot(a({},e,{incomingChildren:i,displayedChildren:o,isLeaving:n,removeFromTree:r}))}},t}(r.Component);window.posed=mt,window.PoseGroup=xt});
